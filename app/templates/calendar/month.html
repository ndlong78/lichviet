{% extends "base.html" %}
{% from "macros/calendar_macros.html" import render_date %}

{% block title %}Calendar Month {{ month }}/{{ year }}{% endblock %}

{% block content %}
<div class="calendar-container">
    <div class="calendar-header">
        <h2>Month {{ month_name }} {{ year }}</h2>
        <div class="calendar-navigation">
            <a href="{{ url_for('main.month_view', year=prev_month[0], month=prev_month[1]) }}" 
               class="nav-btn"><i class="fas fa-chevron-left"></i></a>
            <a href="{{ url_for('main.month_view') }}" 
               class="nav-btn today-btn">This Month</a>
            <a href="{{ url_for('main.month_view', year=next_month[0], month=next_month[1]) }}" 
               class="nav-btn"><i class="fas fa-chevron-right"></i></a>
        </div>
    </div>

    <div class="calendar-grid">
        <div class="weekday-header">
            <div>Sun</div>
            <div>Mon</div>
            <div>Tue</div>
            <div>Wed</div>
            <div>Thu</div>
            <div>Fri</div>
            <div>Sat</div>
        </div>

        {% for week in calendar_data %}
        <div class="week-row">
            {% for day in week %}
            {% if day != 0 %}
                {{ render_date(
                    date=day,
                    events=events|filter_events_by_date(day.day, day.month, day.year),
                    is_today=is_today(day.day, day.month, day.year),
                    is_other_month=false
                ) }}
                <small class="lunar-date">{{ get_lunar_date(day) }}</small> <!-- Display lunar date -->
            {% else %}
                <div class="date-cell empty"></div>
            {% endif %}
            {% endfor %}
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}